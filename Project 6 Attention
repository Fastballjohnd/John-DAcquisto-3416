1. get_mask_token_index
Retrieve the index of the mask token in a tokenized input sequence.

def get_mask_token_index(mask_token_id, inputs):
    """Return the index of the mask token in the input sequence."""
    try:
        return inputs.input_ids.index(mask_token_id)
    except ValueError:
        return None
        
        2. get_color_for_attention_score
Map an attention score (0 to 1) to an RGB grayscale color.

def get_color_for_attention_score(attention_score):
    """Convert attention score into grayscale RGB values."""
    shade = int(round(255 * attention_score))
    return (shade, shade, shade)
    
    3. visualize_attentions
Generate diagrams for all attention heads across layers.

def visualize_attentions(tokens, attentions):
    """Generate diagrams for all attention heads across layers."""
    num_layers = len(attentions)
    num_heads = attentions[0].shape[2]

    for layer_index in range(num_layers):
        for head_index in range(num_heads):
            generate_diagram(layer_index + 1, head_index + 1, tokens, attentions[layer_index][0][head_index])
            
            
